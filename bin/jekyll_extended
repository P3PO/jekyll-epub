#/usr/bin/env ruby

require 'rubygems'

version = ">= 0"

if ARGV.first =~ /^_(.*)_$/ and Gem::Version.correct? $1 then
  version = $1
  ARGV.shift
end

gem 'jekyll', version
jekyll_path = Gem.bin_path('jekyll', 'jekyll', version)
exec_path = File.join( Dir.pwd, "_extensions" )

require 'jekyll'

if File.directory?( exec_path )
	$stderr.puts "* Load extensions :"
	Dir.glob( File.join( exec_path, "**", "*.rb" ) ) do |ext|
		$stderr.puts "  - #{File.basename(ext)}"
		require ext
	end
	puts
end

load jekyll_path
